<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta name="description" content="How to use pass and oathtool to generate 2FA codes easily.">
    <link href="css/theme.css" rel="stylesheet" type="text/css">
      <link href="css/rainbow-github.css" rel="stylesheet" type="text/css">
    <link
      rel="alternate" type="application/atom+xml"
      href="https://blog.separateconcerns.com/feed.atom"
    />
    <title>Two-factor authentication with pass and oathtool</title>
  </head>
  <body>
    <div id="container">
    <header>
      <h1>Two-factor authentication with pass and oathtool</h1>
      <h4>
        published 2020-04-03
        [ <a href="index.html">home</a> ]
      </h4>
    </header>
    

<p>If you&#39;re like me, you don&#39;t want to depend on your phone to log into a website, and you wish <a href="https://www.passwordstore.org">your favorite password manager</a> would support 2FA. Well, it can.</p>

<p>When asked to setup 2FA on a website, get a text code. If the website doesn&#39;t give you that option, just use <a href="http://zbar.sourceforge.net">zbar</a>. For instance, with the QR code from the <a href="https://help.github.com/en/github/authenticating-to-github/configuring-two-factor-authentication">GitHub documentation</a>:</p>

<pre><code>$ zbarimg totp-click-enter-code.png
QR-Code:otpauth://totp/GitHub:LyaLya?secret=qmli3dwqm53vl7fy&amp;issuer=GitHub
scanned 1 barcode symbols from 1 images in 0.03 seconds
</code></pre>

<p>Once you get the secret, put the command line to generate a code using <a href="https://www.nongnu.org/oath-toolkit/oathtool.1.html">oathtool</a> in <code>2fa/github</code> in <code>pass</code> like this:</p>

<pre><code>oathtool --totp --base32 qmli3dwqm53vl7fy
</code></pre>

<p>Finally, add this to your <code>.bashrc</code> (or the equivalent for whatever shell you use):</p>

<pre><code>2fa () { eval $(pass 2fa/$1) ; }
</code></pre>

<p>You can now get your 2FA codes like this:</p>

<pre><code>$ 2fa github
795864
</code></pre>

All the tools used in that article are <a href="https://www.archlinux.org/packages/community/any/pass/">available</a> <a href="https://www.archlinux.org/packages/community/x86_64/oath-toolkit/">as</a> <a href="https://www.archlinux.org/packages/extra/x86_64/zbar/">packages</a> in the Arch Linux repositories.
    </div>
    <div id="footer">
      [ <a href="index.html">home</a> ]
    </div>
    <script src="js/rainbow.min.js"></script>
  </body>
</html>
